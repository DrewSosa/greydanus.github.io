<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Taming Wave Functions with Neural Networks</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Science with a spirit of adventure.">
    <link rel="canonical" href="http://greydanus.github.io/assets/2017-07-28-quantum-nn/">
    <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Sam's Research Blog posts" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/style.css">

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-72311215-6', 'auto');
      ga('send', 'pageview');

    </script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

</head>


    <body>

    <header class="site-header">

  <div class="wrap">

    <div style="float:left; margin-top:10px; margin-right:10px;">
    <a href="https://en.wikipedia.org/wiki/K%C3%A1rm%C3%A1n_vortex_street">
      <img src="/assets/karman.png" width="40">
    </a>
    </div>

    <a class="site-title" href="/">Sam's Research Blog</a>
    
    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        
          <a class="page-link" href="/assets/2017-07-28-quantum-nn/">Taming Wave Functions with Neural Networks</a>
        
          
        
          <a class="page-link" href="/papers/">Interesting papers</a>
        
        <a class="page-link" href="https://greydanus.github.io/about.html">About</a>
      </div>
    </nav>
  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>Taming Wave Functions with Neural Networks</h1>
    <p class="meta">Jul 28, 2017</p>
  </header>

  <article class="post-content">
  <div class="imgcap">
    <img src="/assets/quantum-nn/he-protec-psi.png" width="40%" />
</div>

<h2 id="the-wave-function-in-the-wild">The wave function in the wild</h2>

<blockquote>
  <p>”\(\psi\) is a monolithic mathematical quantity that contains all the information on a quantum state, be it a single particle or a complex molecule.” – Carleo and Troyer, <a href="http://science.sciencemag.org/content/355/6325/602.full">Science</a></p>
</blockquote>

<p><strong>A mixed blessing.</strong> Carleo and Troyer were correct, but the wave function, <script type="math/tex">\psi</script>, is a mixed blessing. Most newcomers to quantum mechanics encounter it as the Schrodinger’s cat paradox – a devious violation of classical intuitions. It also has a mind-bending property called <em>nonlocality</em>, which says that entangled states can “collapse” into pure states instantaneously over large distances. This “spooky action at a distance” frustrated Einstein and eventually led to Bell’s theorem, which was difficult to <a href="https://phys.org/news/2017-02-physicists-loophole-bell-inequality-year-old.html">verify without loopholes</a>.</p>

<p>Worst of all, \(\psi\) grows exponentially with the number of particles in a system. For a system of four particles, \(\psi\) is a vector of length 16. For a system of 100 particles, it has length 10\(^{30}\). This is a huge problem: we couldn’t even <em>write</em> this wave function to a computer’s memory, much less perform operations on it. And yet, if we want to get quantum computers to work, we need to be comfortable with wave functions for well over 100 particles.</p>

<p><strong>Redeeming qualities.</strong> Despite its flaws, we (a couple of luckless physicists) love \(\psi\)! Manipulating wave functions can give us <a href="https://www.nature.com/news/2010/100331/full/news.2010.163.html">ultra-precise timekeeping</a>, <a href="http://physicsworld.com/cws/article/news/2017/jul/11/quantum-satellites-demonstrate-teleportation-and-encryption">secure encryption</a>, and <a href="https://quantumfrontiers.com/2013/03/17/post-quantum-cryptography/">polynomial-time factoring of integers</a> (read: break RSA). Harnessing quantum effects can also produce <a href="https://www.technologyreview.com/s/544421/googles-quantum-dream-machine/">better machine learning</a>, <a href="https://phys.org/news/2013-10-feynman-wasnt-quantum-dynamics-ground.html">better physics simulations</a>, and even <a href="https://quantumfrontiers.com/2012/09/17/how-to-build-a-teleportation-machine-teleportation-protocol/">quantum teleportation</a>.</p>

<h2 id="taming-the-beast">Taming the beast</h2>

<p><strong>The general idea.</strong> Though \(\psi\) grows exponentially with the number of particles in a system, most <em>physical</em> wave functions can be described with a lot less information. In other words, we can write down compressed versions of most wave functions. Obtaining these compressed versions in practice, though, is something of a challenge. Two main approaches are the Density Matrix Renormalization Group (DMRG) and Quantum Monte Carlo (QMC). I’ll give a brief intuition of both.</p>

<div class="imgcap">
    <img src="/assets/quantum-nn/bonsai.png" width="40%" />
</div>

<p><strong>DMRG: it’s like a Bonsai tree.</strong> Imagine we want to learn about trees, but studying a full-grown, 50-foot tall tree is too unwieldy. Any good physicist would tell you to solve a simpler problem: start with a seedling and prune its branches and roots so that it matures, but never grows more than a few feet high. Now it has all the important attributes of a regular tree: branches, leaves, and even a bunch of miniature rings in its trunk (one for each year) – and it’s very easy to study inside a laboratory. In this metaphor, the regular tree is the wave function, the Bonsai process is DMRG, and the Bonsai tree itself is a Matrix Product State (MPS).</p>

<p>This approach is great because it makes the wave function much more manageable while retaining its most important characteristics. The weakness of MPS is that it doesn’t work for <em>all</em> wave functions. For example, systems that interact in 2D and 3D require different techniques such as <a href="https://arxiv.org/abs/0907.2796">Projected Entangled Pairs (PEPS)</a>.</p>

<div class="imgcap">
    <img src="/assets/quantum-nn/leaf.jpg" width="15%" />
    <img src="/assets/quantum-nn/acorn.jpg" width="15%" />
    <img src="/assets/quantum-nn/bark.jpg" width="15%" />
</div>

<p><strong>QMC: collect some specimens.</strong> Another way to study the concept of a “tree” in a lab (bear with me on this improbable metaphor) would be to study a bunch of leaves, seeds, and bark samples from the tree. Obtaining these samples is much easier than obtaining the tree itself and it still gives us a pretty good idea of the tree’s appearance, age, climate, and so forth. Most QMC algorithms do this. They take “specimens” of a wave function by using it to sample a distribution of pure states. Then, from the properties of these states (e.g. energy expectation values), they piece togethe a picture of the wave function as a whole.</p>

<p>This approach is effective because, unlike DMRG, it works for pretty much any quantum system. Its weakness (or perhaps strength?) is that it treats the wave function as a black box. This makes interpreting QMC results is difficult. We might ask, “how does flipping the spin of the third electron affect the total energy?” and QMC wouldn’t have a great answer.</p>

<h2 id="brains-gg-brawn">Brains <script type="math/tex">\gg</script> Brawn</h2>

<div class="imgcap_noborder">
    <img src="/assets/quantum-nn/nqs.jpg" width="40%" />
    <div class="thecap" style="text-align:center">Figure 1. A schema of the Neural Quantum State (NQS) model introduced By Carleo and Troyer. The model has a Restricted Boltzman Machine (RBM) architecture -- increasing the number of units in the hidden layer increases accuracy.</div>
</div>

<p><strong>NQS: smart Monte Carlo.</strong> Some state spaces are far too large for even Monte Carlo to sample adequately. Extending our tree analogy, suppose we’re studying a forest full of different species of trees. We want to study all the species, but one or two types of tree vastly outnumber the others. Randomly sampling branches, bark, etc. from the entire forest just isn’t efficient. Somehow, we need to make our sampling process “smarter”. Last year, Google DeepMind used a technique called deep reinforcement learning to do just that - and achieved great fame for defeating the world champion human player in Go.</p>

<p>In a recent <a href="http://science.sciencemag.org/content/355/6325/602.full">Science paper</a>, Carleo and Troyer used the same technique to approximate many-body wave functions with neural networks. Their called their approach “Neural Quantum States (NQS)”. It worked really well, producing several state-of-the art results.</p>

<div class="imgcap_noborder">
    <img src="/assets/quantum-nn/mps-learn-schema.png" width="100%" />
    <div class="thecap" style="text-align:center">Figure 2: A schema of the neural network model I used to obtain MPS coefficients. The Hamiltonian I'm using is a Heisenberg Hamiltonain plus extra coupling terms (see <a href="https://github.com/greydanus/psi0nn/blob/master/static/greydanus-dartmouth-thesis.pdf">my thesis</a> for details.).</div>
</div>

<p><strong>My thesis.</strong> My undergraduate thesis, which I conducted under fearless <a href="http://jdwhitfield.com/">Professor James Whitfield</a> of Dartmoth College, centered upon much the same idea. In fact, I had to abandon a fair bit of my initial work after reading the NQS paper. I then centered my research around using machine learning techniques to obtain MPS coefficients. Like Carleo and Troyer, I used neural networks to approximate \(\psi\). Unlike Carleo and Troyer, my model produced a set of MPS coefficients which had some physical meaning (MPS coefficients always correspond to a certain state and site, e.g. “spin up, electron number 3”).</p>

<script type="math/tex; mode=display">\label{eqn:mps-definition}
  \lvert \psi_{mps} \rangle=\sum_{s_1,\dots,s_N=1}^d Tr(A[1]^{s_1}, \dots A[N]^{s_N}) \lvert s_1, \dots s_N \rangle</script>

<p><strong>A word about MPS.</strong> I should quickly explain what, exactly, a Matrix Product State <em>is</em>. Check out the equation above, which is the definition of MPS. The idea is to multiply a set of matrices, <script type="math/tex">A</script> together and take the trace of the result. Each <script type="math/tex">A</script> matrix corresponds to a particular site, <script type="math/tex">A[n]</script>, (e.g. “electron 3”) and a particular state, <script type="math/tex">A^{s_i}</script> (e.g. “spin <script type="math/tex">\frac{1}{2}</script>”). Each of the values obtained from the trace operation becomes a single coefficient of <script type="math/tex">\psi</script>, corresponding to a particular state <script type="math/tex">\lvert s_1, \dots s_N \rangle</script>.</p>

<h2 id="cool----but-does-it-work">Cool – but does it work?</h2>

<p><strong>Yes – for small systems.</strong> In my thesis, I considered a toy system of 4 spin-<script type="math/tex">\frac{1}{2}</script> particles interacting via the Heisenberg Hamiltonian. Solving this system, even via exact diagonalization, is pretty trivial. That’s why I chose it – it was easy to observe all the moving parts. Sure enough, I my model was able to find the ground state energy of the system with arbitrary precision.</p>

<p><strong>Achievements.</strong> Not only could my model obtain good estimates of quantum ground states, it recovered approximate Matrix Product State (MPS) coefficients automatically. Shown below, for example, is a visualization of my model’s MPS coefficients for the <a href="https://en.wikipedia.org/wiki/Greenberger%E2%80%93Horne%E2%80%93Zeilinger_state">GHZ state</a>, compared to one taken from the <a href="http://www2.mpq.mpg.de/Theorygroup/CIRAC/wiki/images/9/9f/Eckholt_Diplom.pdf">MPS literature</a>.</p>

<div class="imgcap_noborder">
    <img src="/assets/quantum-nn/ghz-literature.png" width="46%" />
    <img src="/assets/quantum-nn/ghz-mps-learn.png" width="46%" />
    <img src="/assets/quantum-nn/ghz-colorscale.png" width="7%" />
    <div class="thecap" style="text-align:center">Visual comparison of a 4-site Matrix Product State for the GHZ state a) listed in the literature b) obtained from my neural network model.</div>
</div>

<p><strong>Limitations.</strong> The careful reader might point out that, according to Figure 2, I still have to write out the full wave function. In order to scale up my approach, I needed to solve the same problem without ever explicitly writing \(\psi\). There were two options:</p>

<ul>
  <li>
    <ol>
      <li><em>Evaluate energy locally</em>: there’s a formula in <a href="http://www2.mpq.mpg.de/Theorygroup/CIRAC/wiki/images/9/9f/Eckholt_Diplom.pdf">this paper</a>. I tried to implement it but, well, there’s only so much a clueless undergrad can get to work.</li>
      <li><em>Train variationally</em>: This is what the NQS paper did, and the approach I’m currently working on. Results are decent, but the training itself has been pretty unstable so far.</li>
    </ol>
  </li>
</ul>

<p>I’m still working on this project, but it should be finished soon – look out for a paper soon!</p>

<h2 id="outside-the-ivory-tower">Outside the ivory tower</h2>

<div class="imgcap_noborder">
    <img src="/assets/quantum-nn/qcomputer.jpg" width="40%" />
    <div class="thecap" style="text-align:center">A quantum computer developed by Joint Quantum Institute, U. Maryland (photo taken from <a href="https://www.nature.com/news/quantum-computers-ready-to-leap-out-of-the-lab-in-2017-1.21239">this</a> Nature article).</div>
</div>

<p>Quantum computing is a research field that’s poised to take on <a href="https://www.nature.com/news/quantum-computers-ready-to-leap-out-of-the-lab-in-2017-1.21239">commercial relevance</a>. Taming the wave function is one of the big hurdles we need to clear before this can happen. Hopefully, my findings will have a small role to play in making this happen.</p>

<p>Thanks for reading. If you found this post interesting, I encourage you to check out my <a href="http://greydanus.github.io/about.html">personal research blog</a> or get in touch with me directly (sam dot 17 at dartmouth dot edu).</p>

  </article>

  <!-- mathjax -->
  
  <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  

  <!-- disqus comments -->
 
  <div id="disqus_thread"></div>
  <script>
      /**
       *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
       *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
       */
      /*
      var disqus_config = function () {
          this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
          this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
      };
      */
      (function() {  // DON'T EDIT BELOW THIS LINE
          var d = document, s = d.createElement('script');
          
          s.src = '//greydanus-blog.disqus.com/embed.js';
          
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  


  
</div>
      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <!-- <h2 class="footer-heading">Sam's Research Blog</h2> -->

    <div class="footer-col-1 column">
      <ul>
        <li>Sam's Research Blog</li>
        <!-- <li><a href="mailto:sam.17(at)dartmouth.edu">sam.17(at)dartmouth.edu</a></li> -->
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/greydanus">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <span class="username">greydanus</span>
          </a>
        </li>
        
      </ul>
    </div>

    <div class="footer-col-3 column">
      <p class="text">Science with a spirit of adventure.</p>
    </div>

  </div>

</footer>


    </body>
</html>